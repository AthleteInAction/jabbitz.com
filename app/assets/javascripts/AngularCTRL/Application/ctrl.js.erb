// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// APPLICATION !!!!!!! APPLICATION !!!!!!! APPLICATION !!!!!!! APPLICATION !!!!!!! APPLICATION !!!!!!!
// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
var Ctrl = ['$scope','$routeParams','$location','$timeout','$interval','API','$window',
	function($scope,$routeParams,$location,$timeout,$interval,API,$window){

		var scope = $scope;

		scope.months = months;
		scope.days = days;

		scope.current_user = API.users.new(current_user);
		if (!scope.current_user.image.url){
			scope.current_user.image = {
				url: "<%= asset_path 'blank-profile-image.png' %>",
				thumb: {
					url: "<%= asset_path 'blank-profile-image-thumb.png' %>"
				}
			}
		}

		scope.location = $location.path().split('/');

		scope.users = API.users;

		scope.search = {};

		scope.searchUsers = function(){

			JP('SEARCH');

			var CLEAN = false;

			var tmp = {};
			angular.forEach(scope.search,function(val,key){

				tmp[key] = val;

				if (key == 'name' && val && val != ''){
					tmp.name = '*'+val+'*';
				}

				if (!val || val == ''){
					delete scope.search[key];
					delete tmp[key];
				}

				if (val || val != ""){CLEAN = true;}

			});

			if (CLEAN){scope.users.get(tmp);}

		};

		JP('APPLICATION');

	}
];